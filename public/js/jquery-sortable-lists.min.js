!function(e){e.fn.sortableLists=function(s){function l(s){if(v.isDragged){var l=v.cEl,t=v.doc,n=v.win;s.pageX||function(e){e.pageY=v.pY,e.pageX=v.pX,e.clientY=v.cY,e.clientX=v.cX}(s),t.scrollTop()>v.rootEl.offset.top-10&&50>s.clientY?v.upScroll?(s.pageY-=f.scroll,e("html, body").each(function(s){e(this).scrollTop(e(this).scrollTop()-f.scroll)}),o(s)):v.upScroll||(v.upScroll=setInterval(function(){v.doc.trigger("mousemove")},50)):t.scrollTop()+n.height()<v.rootEl.offset.top+v.rootEl.el.outerHeight(!1)+10&&50>n.height()-s.clientY?v.downScroll?(s.pageY+=f.scroll,e("html, body").each(function(s){e(this).scrollTop(e(this).scrollTop()+f.scroll)}),o(s)):v.downScroll||(v.downScroll=setInterval(function(){v.doc.trigger("mousemove")},50)):r(v),v.oElOld=v.oEl,l.el[0].style.visibility="hidden",v.oEl=oEl=function(s,l){if(!document.elementFromPoint)return null;var t=v.isRelEFP;if(null===t){var o,r;0<(o=v.doc.scrollTop())&&(t=null==(r=document.elementFromPoint(0,o+e(window).height()-1))||"HTML"==r.tagName.toUpperCase()),0<(o=v.doc.scrollLeft())&&(t=null==(r=document.elementFromPoint(o+e(window).width()-1,0))||"HTML"==r.tagName.toUpperCase())}if(t&&(s-=v.doc.scrollLeft(),l-=v.doc.scrollTop()),t=e(document.elementFromPoint(s,l)),!v.rootEl.el.find(t).length)return null;if(t.is("#sortableListsPlaceholder")||t.is("#sortableListsHint"))return null;if(!t.is("li"))return(t=t.closest("li"))[0]?t:null;if(t.is("li"))return t}(s.pageX,s.pageY),l.el[0].style.visibility="visible",i(s,v),function(e,s){var l=s.cEl;l.el.css({top:e.pageY-l.xyOffsetDiff.Y-l.mT,left:e.pageX-l.xyOffsetDiff.X-l.mL})}(s,v)}}function t(s){var o=v.cEl,i=e("#sortableListsHint",v.rootEl.el),n=g[0].style,a=null,p=!1,d=e("#sortableListsHintWrapper");"block"==n.display&&i.length&&v.isAllowed?(a=i,p=!0):(a=v.placeholderNode,p=!1),offset=a.offset(),o.el.animate({left:offset.left-v.cEl.mL,top:offset.top-v.cEl.mT},250,function(){!function(e){var s=e.el[0].style;e.el.removeClass(f.currElClass+" sortableListsCurrent"),s.top="0",s.left="0",s.position="relative",s.width="auto"}(o),a.after(o.el[0]),a[0].style.display="none",n.display="none",i.remove(),d.removeAttr("id").removeClass(f.hintWrapperClass),d.length&&d.prev("div").append(m.clone(!0)),p?v.placeholderNode.slideUp(150,function(){v.placeholderNode.remove(),c(),f.onChange(o.el),f.complete(o.el),v.isDragged=!1}):(v.placeholderNode.remove(),c(),f.complete(o.el),v.isDragged=!1)}),r(v),v.doc.unbind("mousemove",l).unbind("mouseup",t)}function o(e){v.pY=e.pageY,v.pX=e.pageX,v.cY=e.clientY,v.cX=e.clientX}function r(e){clearInterval(e.upScroll),clearInterval(e.downScroll),e.upScroll=e.downScroll=!1}function i(s,l){var t=l.oEl;if(t&&l.oElOld){var o=t.outerHeight(!1),r=s.pageY-t.offset().top;if(f.insertZonePlus){if(14>r)e:{if(o=7>r,e("#sortableListsHintWrapper",v.rootEl.el).length&&g.unwrap(),!o&&s.pageX-t.offset().left>f.insertZone){if(o=t.children(),(r=t.children(f.listSelector).first()).children().first().is("#sortableListsPlaceholder")){g.css("display","none");break e}r.length?r.prepend(g):(o.first().after(g),g.wrap(b)),v.oEl&&n(t)}else{if(t.prev("#sortableListsPlaceholder").length){g.css("display","none");break e}t.before(g)}g.css("display","block"),v.isAllowed=f.isAllowed(v.cEl.el,g,g.parents("li").first())}else if(o-14<r)e:{if(o=o-7<r,e("#sortableListsHintWrapper",v.rootEl.el).length&&g.unwrap(),!o&&s.pageX-t.offset().left>f.insertZone){if(o=t.children(),(r=t.children(f.listSelector).last()).children().last().is("#sortableListsPlaceholder")){g.css("display","none");break e}r.length?o.last().append(g):(t.append(g),g.wrap(b)),v.oEl&&n(t)}else{if(t.next("#sortableListsPlaceholder").length){g.css("display","none");break e}t.after(g)}g.css("display","block"),v.isAllowed=f.isAllowed(v.cEl.el,g,g.parents("li").first())}}else if(5>r)e:{if(e("#sortableListsHintWrapper",v.rootEl.el).length&&g.unwrap(),s.pageX-t.offset().left<f.insertZone){if(t.prev("#sortableListsPlaceholder").length){g.css("display","none");break e}t.before(g)}else{if(o=t.children(),(r=t.children(f.listSelector).first()).children().first().is("#sortableListsPlaceholder")){g.css("display","none");break e}r.length?r.prepend(g):(o.first().after(g),g.wrap(b)),v.oEl&&n(t)}g.css("display","block"),v.isAllowed=f.isAllowed(v.cEl.el,g,g.parents("li").first())}else if(o-5<r)e:{if(e("#sortableListsHintWrapper",v.rootEl.el).length&&g.unwrap(),s.pageX-t.offset().left<f.insertZone){if(t.next("#sortableListsPlaceholder").length){g.css("display","none");break e}t.after(g)}else{if(o=t.children(),(r=t.children(f.listSelector).last()).children().last().is("#sortableListsPlaceholder")){g.css("display","none");break e}r.length?o.last().append(g):(t.append(g),g.wrap(b)),v.oEl&&n(t)}g.css("display","block"),v.isAllowed=f.isAllowed(v.cEl.el,g,g.parents("li").first())}}}function n(e){e.removeClass("sortableListsClosed").addClass("sortableListsOpen"),e.children(f.listSelector).css("display","block"),e=e.children("div").children(".sortableListsOpener").first(),"html"==f.opener.as?e.html(f.opener.close):"class"==f.opener.as?e.addClass(f.opener.close).removeClass(f.opener.open):e.css("background-image","url("+f.opener.close+")")}function a(e){e.removeClass("sortableListsOpen").addClass("sortableListsClosed"),e.children(f.listSelector).css("display","none"),e=e.children("div").children(".sortableListsOpener").first(),"html"==f.opener.as?e.html(f.opener.open):"class"==f.opener.as?e.addClass(f.opener.open).removeClass(f.opener.close):e.css("background-image","url("+f.opener.open+")")}function c(){e(f.listSelector,v.rootEl.el).each(function(s){e(this).children().length||(e(this).prev("div").children(".sortableListsOpener").first().remove(),e(this).remove())})}var p=e("body").css("position","relative"),d={currElClass:"",placeholderClass:"",placeholderCss:{position:"relative",padding:0},hintClass:"",hintCss:{display:"none",position:"relative",padding:0},hintWrapperClass:"",hintWrapperCss:{},baseClass:"",baseCss:{position:"absolute",top:0-parseInt(p.css("margin-top")),left:0-parseInt(p.css("margin-left")),margin:0,padding:0,"z-index":2500},opener:{active:!1,open:"",close:"",openerCss:{float:"left",display:"inline-block","background-position":"center center","background-repeat":"no-repeat"},openerClass:""},listSelector:"ul",listsClass:"",listsCss:{},insertZone:50,insertZonePlus:!1,scroll:20,ignoreClass:"",isAllowed:function(e,s,l){return!0},onDragStart:function(e,s){return!0},onChange:function(e){return!0},complete:function(e){return!0}},f=e.extend(!0,{},d,s),h=e("<"+f.listSelector+" />").prependTo(p).attr("id","sortableListsBase").css(f.baseCss).addClass(f.listsClass+" "+f.baseClass),u=e("<li />").attr("id","sortableListsPlaceholder").css(f.placeholderCss).addClass(f.placeholderClass),g=e("<li />").attr("id","sortableListsHint").css(f.hintCss).addClass(f.hintClass),b=e("<"+f.listSelector+" />").attr("id","sortableListsHintWrapper").addClass(f.listsClass+" "+f.hintWrapperClass).css(f.listsCss).css(f.hintWrapperCss),m=e("<span />").addClass("sortableListsOpener "+f.opener.openerClass).css(f.opener.openerCss).on("mousedown",function(s){return(s=e(this).closest("li")).hasClass("sortableListsClosed")?n(s):a(s),!1});"class"==f.opener.as?m.addClass(f.opener.close):"html"==f.opener.as?m.html(f.opener.close):(m.css("background-image","url("+f.opener.close+")"),console.error("jQuerySortableLists opener as background image is deprecated. In version 2.0.0 it will be removed. Use html instead please."));var v={isDragged:!1,isRelEFP:null,oEl:null,rootEl:null,cEl:null,upScroll:!1,downScroll:!1,pX:0,pY:0,cX:0,cY:0,isAllowed:!0,e:{pageX:0,pageY:0,clientX:0,clientY:0},doc:e(document),win:e(window)};if(f.opener.active){if(!f.opener.open)throw"Opener.open value is not defined. It should be valid url, html or css class.";if(!f.opener.close)throw"Opener.close value is not defined. It should be valid url, html or css class.";e(this).find("li").each(function(){var s=e(this);s.children(f.listSelector).length&&(m.clone(!0).prependTo(s.children("div").first()),s.hasClass("sortableListsOpen")?n(s):a(s))})}return this.on("mousedown",function(s){var o=e(s.target);if(!(!1!==v.isDragged||f.ignoreClass&&o.hasClass(f.ignoreClass))){s.preventDefault();o=o.closest("li");var r=e(this);if(o[0]){f.onDragStart(s,o),v.isDragged=!0;var i=parseInt(o.css("margin-top")),n=parseInt(o.css("margin-bottom")),a=parseInt(o.css("margin-left")),c=parseInt(o.css("margin-right")),p=o.offset(),d=o.innerHeight();v.rootEl={el:r,offset:r.offset(),rootElClass:r.attr("class")},v.cEl={el:o,mT:i,mL:a,mB:n,mR:c,offset:p},v.cEl.xyOffsetDiff={X:s.pageX-v.cEl.offset.left,Y:s.pageY-v.cEl.offset.top},v.cEl.el.addClass("sortableListsCurrent "+f.currElClass),o.before(u),s=v.placeholderNode=e("#sortableListsPlaceholder"),o.css({width:o.width(),position:"absolute",top:p.top-i,left:p.left-a}).prependTo(h),s.css({display:"block",height:d}),g.css("height",d),v.doc.on("mousemove",l).on("mouseup",t)}}})},e.fn.sortableListsToArray=function(s,l){s=s||[];var t=0;return this.children("li").each(function(){var o=e(this),r={},i=o.attr("id");if(!i)throw console.log(o),"Previous item in console.log has no id. It is necessary to create the array.";r.id=i,r.parentId=l,r.value=o.data("value"),r.order=t,s.push(r),o.children("ul,ol").sortableListsToArray(s,i),t++}),s},e.fn.sortableListsToHierarchy=function(){var s=[],l=0;return e(this).children("li").each(function(){var t=e(this),o={},r=t.attr("id");if(!r)throw console.log(t),"Previous item in console.log has no id. It is necessary to create the array.";o.id=r,o.value=t.data("value"),o.order=l,s.push(o),o.children=t.children("ul,ol").sortableListsToHierarchy(),l++}),s},e.fn.sortableListsToString=function(s,l){return s=s||[],l=l||"no-parent",e(this).children("li").each(function(){var t,o=e(this);if(!(t=(t=o.attr("id"))?t.match(/(.+)[-=_](.+)/):null))throw console.log(o),"Previous item in console.log has no id or id is not in required format xx_yy, xx-yy or xx=yy. It is necessary to create valid string.";s.push(t[1]+"["+t[2]+"]="+l),e(this).children("ul,ol").sortableListsToString(s,t[2])}),s.join("&")}}(jQuery);
;